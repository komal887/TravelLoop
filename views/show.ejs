<% layout("layouts/boilerplate") %>

<div class="container mt-5">
   <!----<h1 class="text-center mb-4">Explore Individual Packages</h1> -->

    <div class="row justify-content-center">
        <div class="col-md-8">

            <div class="card shadow-lg border-0 rounded-3">
                <!-- Package Image -->
                <img src="<%= travel.imageURL %>" class="card-img-top img-fluid rounded-top" alt="Tour Package Image">

                <!-- Card Body -->
                <div class="card-body">
                    <h3 class="card-title text-primary fw-bold"><%= travel.packageName %></h3>
                    <p><i>Owned by <%= travel.owner.username %></i></p>
                    <p class="card-text text-muted"><%= travel.description %></p>

                    <ul class="list-group list-group-flush mb-3">
                        <li class="list-group-item"><strong>Includes:</strong> <%= travel.includes.join(", ") %></li>
                        <li class="list-group-item"><strong>Image File Name:</strong> <%= travel.imageFileName %></li>
                        <li class="list-group-item"><strong>Price:</strong> ₹<%= travel.price.toLocaleString("en-EN") %></li>
                        <li class="list-group-item"><strong>Location:</strong> <%= travel.location %></li>
                        <li class="list-group-item"><strong>Country:</strong> <%= travel.country %></li>
                    </ul>

                    <!-- Action Buttons -->
                    <div class="d-flex justify-content-between mt-3">
                        <!-- Edit Button -->
                        <a href="/travel/<%= travel.id %>/edit" class="btn btn-success me-2">
                            <i class="bi bi-pencil-square"></i> Edit
                        </a>

                        <!-- Delete Button with confirmation -->
                        <form action="/travel/<%= travel.id %>?_method=DELETE" method="POST" 
                              onsubmit="return confirm('Are you sure you want to delete this package?');">
                            <button type="submit" class="btn btn-outline-danger">
                                <i class="bi bi-trash"></i> Delete
                            </button>
                        </form>
                    </div>

                </div>
            </div>

        </div>
    </div>
</div>

<hr>
<h4 class="mb-4">Leave a Review</h4>
<form action="/travel/<%= travel.id %>/reviews" method="POST" novalidate class="needs-validation mb-5">
    <div class="mb-3">
        <label for="rating" class="form-label fw-bold">Rating</label>
        <input type="range" class="form-range" min="1" max="5" id="rating" name="review[rating]">
    </div>
    <div class="mb-3">
        <label for="comments" class="form-label fw-bold">Comments</label>
        <textarea name="review[comments]" id="comments" rows="4" class="form-control" required></textarea>
    </div>
    <button class="btn btn-success">Submit</button>
</form>

<hr />
<h2 class="mb-4">All Reviews</h2>

<div class="row">
    <% if(travel.reviews.length === 0){ %>
        <p class="text-muted">No reviews yet. Be the first to review this package!</p>
    <% } else { %>
        <% for (let review of travel.reviews) { %>
            <div class="col-md-6 mb-4">
                <div class="card shadow-sm border-0 rounded-3 h-100">
                    <div class="card-body">
                        <!-- Stars -->
                        <p class="mb-2">
                            <% for (let i = 0; i < review.rating; i++) { %>
                                <span class="text-warning">★</span>
                            <% } %>
                            <% for (let i = review.rating; i < 5; i++) { %>
                                <span class="text-muted">☆</span>
                            <% } %>
                        </p>
                        <!-- Comment -->
                        <p class="card-text"><%= review.comments %></p>
                        <footer class="blockquote-footer">Traveler</footer>
                    </div>
                </div>
            </div>
        <% } %>
    <% } %>
</div>
